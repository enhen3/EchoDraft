# 📦 EchoDraft 完整上传指南

## 🎯 目标

创建一个GitHub仓库，让用户可以：
- **开发者**：下载源代码，自行构建
- **普通用户**：下载DMG文件，直接使用（无需任何配置）

## 为什么用 DMG 而不是 ZIP？

之前的 ZIP 文件在其他用户电脑上显示"文件受损"，原因可能是：
- ❌ ZIP 在处理大文件时可能损坏
- ❌ 某些解压工具不兼容 macOS 的 .app bundle
- ❌ 文件传输过程中可能损坏

**DMG 的优势**：
- ✅ macOS 官方分发格式，最可靠
- ✅ 保持所有文件属性和权限
- ✅ 不会在传输中损坏
- ✅ 可以设置自定义外观
- ✅ 更专业

## 📋 完整步骤

### 步骤 1: 创建 DMG 文件

在终端运行：

```bash
cd /Users/haoyangs/EchoDraft

# 给脚本添加执行权限
chmod +x create_dmg_from_existing.sh

# 创建 DMG
./create_dmg_from_existing.sh
```

这会：
1. 重新构建应用（使用 EchoDraft 名称）
2. 创建 DMG 镜像文件
3. 生成 SHA256 校验和

完成后会得到：
- `EchoDraft-macOS-v1.0.0.dmg` （约600-700 MB）
- `EchoDraft-macOS-v1.0.0.dmg.sha256` （校验和）

### 步骤 2: 上传源代码到 GitHub

```bash
cd /Users/haoyangs/EchoDraft

# 给上传脚本添加执行权限
chmod +x upload_to_github.sh

# 运行上传脚本
./upload_to_github.sh
```

这会：
1. 清理构建产物和临时文件
2. 初始化 Git 仓库
3. 提交源代码（不包含大型模型文件）
4. 推送到 https://github.com/enhen3/EchoDraft

### 步骤 3: 创建 GitHub Release 并上传 DMG

#### 方法 A: 使用 GitHub CLI（推荐，最简单）

```bash
cd /Users/haoyangs/EchoDraft

# 创建 Release 并上传 DMG
gh release create v1.0.0 \
  EchoDraft-macOS-v1.0.0.dmg \
  EchoDraft-macOS-v1.0.0.dmg.sha256 \
  --title "EchoDraft v1.0.0 - macOS 应用" \
  --notes "## 🎙️ EchoDraft - 本地语音转写工具

### ✨ 特性

- 🌍 自动识别多种语言（中英西法德日韩俄等）
- 🔒 完全离线运行，保护隐私
- 📊 实时进度显示
- 🎨 macOS 原生风格界面

### 📦 下载安装

1. 下载 \`EchoDraft-macOS-v1.0.0.dmg\`
2. 双击打开 DMG
3. 将 EchoDraft.app 拖到"应用程序"文件夹
4. 首次打开：右键点击应用 → 选择"打开"

### 💻 系统要求

- macOS 10.15+
- Apple Silicon (M1/M2/M3/M4) 或 Intel
- 2GB 内存
- 1.5GB 磁盘空间

### 📖 详细说明

查看仓库中的 README.md 了解更多信息。

### 🔐 文件校验

SHA256: 见 \`EchoDraft-macOS-v1.0.0.dmg.sha256\` 文件
"
```

#### 方法 B: 通过 GitHub 网站手动上传

1. 访问 https://github.com/enhen3/EchoDraft
2. 点击右侧的 "Releases" → "Create a new release"
3. 填写信息：
   - Tag: `v1.0.0`
   - Title: `EchoDraft v1.0.0 - macOS 应用`
   - Description: （复制上面方法A中的notes内容）
4. 上传文件：
   - 拖入 `EchoDraft-macOS-v1.0.0.dmg`
   - 拖入 `EchoDraft-macOS-v1.0.0.dmg.sha256`
5. 点击 "Publish release"

## ✅ 完成后的效果

### 对于普通用户：

访问 https://github.com/enhen3/EchoDraft/releases

1. 下载 `EchoDraft-macOS-v1.0.0.dmg`
2. 双击打开
3. 拖到"应用程序"
4. 直接使用 ✨

**不需要**：
- ❌ 安装 Python
- ❌ 下载模型
- ❌ 任何配置
- ❌ 命令行操作

### 对于开发者：

```bash
git clone https://github.com/enhen3/EchoDraft.git
cd EchoDraft
pip install -r requirements.txt
# 下载模型...
python3 app.py
```

## 🔍 验证上传成功

访问以下链接确认：

1. **源代码仓库**：https://github.com/enhen3/EchoDraft
   - 应该能看到所有源代码文件
   - README.md 正常显示

2. **Release 页面**：https://github.com/enhen3/EchoDraft/releases
   - 应该能看到 v1.0.0 release
   - 有 DMG 文件可以下载

## 📊 最终文件大小对比

- **Git 仓库**：约 10-20 MB（只有源代码）
- **DMG 文件**：约 600-700 MB（完整应用）
- **总下载**：
  - 普通用户：600-700 MB（只下载DMG）
  - 开发者：10-20 MB（clone仓库）+ 模型（自己下载）

## 🎉 后续使用

### 用户下载流程：

1. 访问 GitHub Release 页面
2. 下载 DMG 文件
3. 打开 DMG
4. 拖到"应用程序"
5. 开始使用

### 更新版本时：

```bash
# 1. 修改代码...
# 2. 重新构建并创建DMG
./create_dmg_from_existing.sh

# 3. 提交代码更新
git add .
git commit -m "feat: 新功能描述"
git push

# 4. 创建新的Release
gh release create v1.0.1 \
  EchoDraft-macOS-v1.0.1.dmg \
  --title "EchoDraft v1.0.1" \
  --notes "更新说明..."
```

## 🆘 常见问题

### Q: DMG 创建失败？

确保已经运行过 `./build_mac_app.sh` 并且 `dist/EchoDraft.app` 存在。

### Q: 上传到 GitHub 需要登录？

配置 Git 凭证：
```bash
git config --global user.name "你的名字"
git config --global user.email "你的邮箱"
```

### Q: Release 上传失败？

使用 `gh auth login` 登录 GitHub CLI。

### Q: 用户说下载的 DMG 打不开？

这种情况极少见，DMG 比 ZIP 可靠得多。如果出现，让用户：
1. 验证 SHA256 校验和
2. 重新下载（可能网络问题）
3. 在终端运行 `hdiutil verify EchoDraft-macOS-v1.0.0.dmg`

---

## 🚀 开始执行

现在就运行：

```bash
cd /Users/haoyangs/EchoDraft
chmod +x create_dmg_from_existing.sh upload_to_github.sh
./create_dmg_from_existing.sh
./upload_to_github.sh
# 然后创建 Release 上传 DMG
```

祝你成功！🎉
